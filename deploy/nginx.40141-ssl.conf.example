# Serve the static PWA directly on port 40141 with HTTPS

server {
    listen 40141 ssl http2;
    server_name mangaverse.tojest.dev;  # change if needed

    ssl_certificate     /etc/letsencrypt/live/mangaverse.tojest.dev/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/mangaverse.tojest.dev/privkey.pem;

    root /var/www/mangaverse;      # path to `dist` contents
    index index.html;

    location = /manifest.webmanifest {
        add_header Content-Type application/manifest+json;
        try_files $uri =404;
    }
    location = /sw.js {
        add_header Cache-Control no-cache;
        try_files $uri =404;
    }
    location /icons/ {
        expires 30d;
        add_header Cache-Control public;
        try_files $uri =404;
    }
    location / { try_files $uri $uri/ /index.html; }

    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss image/svg+xml;
}
