server {
	listen 40141 default_server;
	listen [::]:40141 default_server;

	server_name mangaverse.tojest.dev; # możesz zostawić _; jeśli chcesz akceptować każdy Host

	root /usr/share/nginx/html;
	index index.html;

	# Manifest z poprawnym MIME
	location = /manifest.webmanifest {
		add_header Content-Type application/manifest+json;
		try_files $uri =404;
	}

	# Service Worker bez twardego cache
	location = /sw.js {
		add_header Cache-Control no-cache;
		try_files $uri =404;
	}

	# Ikony i inne assety
	location /icons/ {
		expires 30d;
		add_header Cache-Control public;
		try_files $uri =404;
	}

	# SPA routing: fallback do index.html
	location / {
		try_files $uri $uri/ /index.html;
	}

	gzip on;
	gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss image/svg+xml;
}

